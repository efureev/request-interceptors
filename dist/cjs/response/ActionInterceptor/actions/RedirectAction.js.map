{"version":3,"file":"RedirectAction.js","names":["RedirectAction","data","interceptorConfig","requestExtra","url","target","configLayer","response","test","openUrl","URL","window","location","origin","a","document","createElement","setAttribute","toString","click","done","ErrorAction","BaseAction"],"sources":["../../../../../src/response/ActionInterceptor/actions/RedirectAction.ts"],"sourcesContent":["import type { RawDataType } from './BaseAction'\nimport BaseAction from './BaseAction'\nimport ErrorAction from './ErrorAction'\nimport type { ActionInterceptorConfig } from '../ActionInterceptor'\nimport type { LayerConfig } from '@feugene/layer-request'\nimport { ExtraProperties } from '@feugene/layer-request'\nimport type { AxiosResponse } from 'axios'\nimport type ResponseWrapper from '../../WrapperInterceptor/ResponseWrapper'\n\ninterface RedirectRawDataType extends RawDataType {\n  url: string\n  target?: string\n}\n\n\nexport default class RedirectAction extends BaseAction {\n  private readonly url: string\n  private readonly target: string = '_self'\n\n  constructor(data: RawDataType, interceptorConfig: ActionInterceptorConfig, requestExtra: ExtraProperties) {\n    super(data, interceptorConfig, requestExtra)\n\n    this.url = data.url\n\n    const target = data.target\n    if (target === '_blank' || target === '_self') {\n      this.target = target\n    }\n  }\n\n  public run(configLayer: LayerConfig, response: AxiosResponse | ResponseWrapper): void {\n    if (/^http(s)?:\\/\\//.test(this.url)) {\n      this.openUrl(new URL(this.url))\n\n      return\n    }\n    this.openUrl(new URL(window.location.origin + this.url))\n  }\n\n  openUrl(url: URL) {\n    const a = document.createElement('a')\n    a.setAttribute('href', url.toString())\n    a.setAttribute('target', this.target)\n    a.click()\n\n    this.done()\n\n    throw new ErrorAction(`Redirect to ${url}`, this)\n  }\n}\n"],"mappings":";;;;;;;;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;IAaqBA,c;;;;;EAInB,wBAAYC,IAAZ,EAA+BC,iBAA/B,EAA2EC,YAA3E,EAA0G;IAAA;;IAAA;;IACxG,0BAAMF,IAAN,EAAYC,iBAAZ,EAA+BC,YAA/B;;IADwG,yDAFxE,OAEwE;;IAGxG,MAAKC,GAAL,GAAWH,IAAI,CAACG,GAAhB;IAEA,IAAMC,MAAM,GAAGJ,IAAI,CAACI,MAApB;;IACA,IAAIA,MAAM,KAAK,QAAX,IAAuBA,MAAM,KAAK,OAAtC,EAA+C;MAC7C,MAAKA,MAAL,GAAcA,MAAd;IACD;;IARuG;EASzG;;;;WAED,aAAWC,WAAX,EAAqCC,QAArC,EAAsF;MACpF,IAAI,iBAAiBC,IAAjB,CAAsB,KAAKJ,GAA3B,CAAJ,EAAqC;QACnC,KAAKK,OAAL,CAAa,IAAIC,GAAJ,CAAQ,KAAKN,GAAb,CAAb;QAEA;MACD;;MACD,KAAKK,OAAL,CAAa,IAAIC,GAAJ,CAAQC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAAyB,KAAKT,GAAtC,CAAb;IACD;;;WAED,iBAAQA,GAAR,EAAkB;MAChB,IAAMU,CAAC,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAV;MACAF,CAAC,CAACG,YAAF,CAAe,MAAf,EAAuBb,GAAG,CAACc,QAAJ,EAAvB;MACAJ,CAAC,CAACG,YAAF,CAAe,QAAf,EAAyB,KAAKZ,MAA9B;MACAS,CAAC,CAACK,KAAF;MAEA,KAAKC,IAAL;MAEA,MAAM,IAAIC,oBAAJ,uBAA+BjB,GAA/B,GAAsC,IAAtC,CAAN;IACD;;;;EAjCyCkB,oB"}