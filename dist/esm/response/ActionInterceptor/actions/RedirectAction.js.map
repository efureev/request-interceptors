{"version":3,"file":"RedirectAction.js","names":["BaseAction","ErrorAction","RedirectAction","target","constructor","data","interceptorConfig","requestExtra","url","run","configLayer","response","test","openUrl","URL","window","location","origin","a","document","createElement","setAttribute","toString","click","done"],"sources":["../../../../../src/response/ActionInterceptor/actions/RedirectAction.ts"],"sourcesContent":["import type { RawDataType } from './BaseAction'\nimport BaseAction from './BaseAction'\nimport ErrorAction from './ErrorAction'\nimport type { ActionInterceptorConfig } from '../ActionInterceptor'\nimport type { LayerConfig } from '@feugene/layer-request'\nimport { ExtraProperties } from '@feugene/layer-request'\nimport type { AxiosResponse } from 'axios'\nimport type ResponseWrapper from '../../WrapperInterceptor/ResponseWrapper'\n\ninterface RedirectRawDataType extends RawDataType {\n  url: string\n  target?: string\n}\n\n\nexport default class RedirectAction extends BaseAction {\n  private readonly url: string\n  private readonly target: string = '_self'\n\n  constructor(data: RawDataType, interceptorConfig: ActionInterceptorConfig, requestExtra: ExtraProperties) {\n    super(data, interceptorConfig, requestExtra)\n\n    this.url = data.url\n\n    const target = data.target\n    if (target === '_blank' || target === '_self') {\n      this.target = target\n    }\n  }\n\n  public run(configLayer: LayerConfig, response: AxiosResponse | ResponseWrapper): void {\n    if (/^http(s)?:\\/\\//.test(this.url)) {\n      this.openUrl(new URL(this.url))\n\n      return\n    }\n    this.openUrl(new URL(window.location.origin + this.url))\n  }\n\n  openUrl(url: URL) {\n    const a = document.createElement('a')\n    a.setAttribute('href', url.toString())\n    a.setAttribute('target', this.target)\n    a.click()\n\n    this.done()\n\n    throw new ErrorAction(`Redirect to ${url}`, this)\n  }\n}\n"],"mappings":"AACA,OAAOA,UAAP,MAAuB,cAAvB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AAaA,eAAe,MAAMC,cAAN,SAA6BF,UAA7B,CAAwC;EAEpCG,MAAM,GAAW,OAAX;;EAEvBC,WAAW,CAACC,IAAD,EAAoBC,iBAApB,EAAgEC,YAAhE,EAA+F;IACxG,MAAMF,IAAN,EAAYC,iBAAZ,EAA+BC,YAA/B;IAEA,KAAKC,GAAL,GAAWH,IAAI,CAACG,GAAhB;IAEA,MAAML,MAAM,GAAGE,IAAI,CAACF,MAApB;;IACA,IAAIA,MAAM,KAAK,QAAX,IAAuBA,MAAM,KAAK,OAAtC,EAA+C;MAC7C,KAAKA,MAAL,GAAcA,MAAd;IACD;EACF;;EAEMM,GAAG,CAACC,WAAD,EAA2BC,QAA3B,EAA4E;IACpF,IAAI,iBAAiBC,IAAjB,CAAsB,KAAKJ,GAA3B,CAAJ,EAAqC;MACnC,KAAKK,OAAL,CAAa,IAAIC,GAAJ,CAAQ,KAAKN,GAAb,CAAb;MAEA;IACD;;IACD,KAAKK,OAAL,CAAa,IAAIC,GAAJ,CAAQC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAAyB,KAAKT,GAAtC,CAAb;EACD;;EAEDK,OAAO,CAACL,GAAD,EAAW;IAChB,MAAMU,CAAC,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAV;IACAF,CAAC,CAACG,YAAF,CAAe,MAAf,EAAuBb,GAAG,CAACc,QAAJ,EAAvB;IACAJ,CAAC,CAACG,YAAF,CAAe,QAAf,EAAyB,KAAKlB,MAA9B;IACAe,CAAC,CAACK,KAAF;IAEA,KAAKC,IAAL;IAEA,MAAM,IAAIvB,WAAJ,CAAiB,eAAcO,GAAI,EAAnC,EAAsC,IAAtC,CAAN;EACD;;AAjCoD"}