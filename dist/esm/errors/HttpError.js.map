{"version":3,"file":"HttpError.js","names":["statusMessage","select","HttpError","Error","statusText","url","constructor","error","status","statusCode","stack","request","responseURL","config","response","data","setMessage","message","hasResponse","toHtml","get","key"],"sources":["../../../src/errors/HttpError.ts"],"sourcesContent":["import statusMessage from '../statuses'\nimport { select } from '@feugene/mu'\nimport type { AxiosError, AxiosRequestConfig, AxiosResponse } from 'axios'\nimport type { Nullable } from '../global'\n\n/**\n * Create instant, which represent error object\n */\nexport default class HttpError extends Error {\n  public readonly statusCode: number\n  public readonly statusText: string = ''\n  public readonly stack?: string\n  public readonly error: AxiosError\n\n  public readonly url: string = ''\n  public config: AxiosRequestConfig\n  public readonly request: any\n  public readonly response: Nullable<AxiosResponse>\n\n  public data: any\n\n  constructor(error: AxiosError, status: number) {\n    super()\n\n    this.statusCode = status\n    this.error = error\n    this.stack = error.stack || new Error().stack\n\n    this.url = error.request?.responseURL\n    this.config = error.config\n\n    this.request = error?.request\n    this.response = error?.response\n\n    if (!!this.response) {\n      this.data = this.response?.data\n\n      this.statusCode = this.response.status\n      this.statusText = statusMessage(this.statusCode)\n\n      this.setMessage()\n    }\n  }\n\n  protected setMessage(message?: string): void {\n    if (!message) {\n      message = this.response?.data?.message\n    }\n\n    this.message = message || 'Unknown Error'\n  }\n\n  public hasResponse(): boolean {\n    return !!this.response\n  }\n\n  public toHtml() {\n    return `<div><div class=\"title\">${this.message}</div><ul class=\"details list-reset\">${\n      this.statusCode && this.statusText ? `<li>[${this.statusCode}] ${this.statusText}</li>` : ''\n    }<li>[url] ${this.url}</li></ul></div>`\n  }\n\n  /**\n   * @example errorWrap.get('response.data.text')\n   */\n  get(key: string): any {\n    return select(this, key)\n  }\n}\n"],"mappings":"AAAA,OAAOA,aAAP,MAA0B,aAA1B;AACA,SAASC,MAAT,QAAuB,aAAvB;;AAIA;AACA;AACA;AACA,eAAe,MAAMC,SAAN,SAAwBC,KAAxB,CAA8B;EAE3BC,UAAU,GAAW,EAAX;EAIVC,GAAG,GAAW,EAAX;;EAOnBC,WAAW,CAACC,KAAD,EAAoBC,MAApB,EAAoC;IAC7C;IAEA,KAAKC,UAAL,GAAkBD,MAAlB;IACA,KAAKD,KAAL,GAAaA,KAAb;IACA,KAAKG,KAAL,GAAaH,KAAK,CAACG,KAAN,IAAe,IAAIP,KAAJ,GAAYO,KAAxC;IAEA,KAAKL,GAAL,GAAWE,KAAK,CAACI,OAAN,EAAeC,WAA1B;IACA,KAAKC,MAAL,GAAcN,KAAK,CAACM,MAApB;IAEA,KAAKF,OAAL,GAAeJ,KAAK,EAAEI,OAAtB;IACA,KAAKG,QAAL,GAAgBP,KAAK,EAAEO,QAAvB;;IAEA,IAAI,CAAC,CAAC,KAAKA,QAAX,EAAqB;MACnB,KAAKC,IAAL,GAAY,KAAKD,QAAL,EAAeC,IAA3B;MAEA,KAAKN,UAAL,GAAkB,KAAKK,QAAL,CAAcN,MAAhC;MACA,KAAKJ,UAAL,GAAkBJ,aAAa,CAAC,KAAKS,UAAN,CAA/B;MAEA,KAAKO,UAAL;IACD;EACF;;EAESA,UAAU,CAACC,OAAD,EAAyB;IAC3C,IAAI,CAACA,OAAL,EAAc;MACZA,OAAO,GAAG,KAAKH,QAAL,EAAeC,IAAf,EAAqBE,OAA/B;IACD;;IAED,KAAKA,OAAL,GAAeA,OAAO,IAAI,eAA1B;EACD;;EAEMC,WAAW,GAAY;IAC5B,OAAO,CAAC,CAAC,KAAKJ,QAAd;EACD;;EAEMK,MAAM,GAAG;IACd,OAAQ,2BAA0B,KAAKF,OAAQ,wCAC7C,KAAKR,UAAL,IAAmB,KAAKL,UAAxB,GAAsC,QAAO,KAAKK,UAAW,KAAI,KAAKL,UAAW,OAAjF,GAA0F,EAC3F,aAAY,KAAKC,GAAI,kBAFtB;EAGD;EAED;AACF;AACA;;;EACEe,GAAG,CAACC,GAAD,EAAmB;IACpB,OAAOpB,MAAM,CAAC,IAAD,EAAOoB,GAAP,CAAb;EACD;;AA3D0C"}